#!/usr/bin/env bash

source "$BIN_DIR/utils"
# shellcheck source=bin/steps/front
source "$BIN_DIR/steps/front"

copy_from_server() {
  local name="${1:?}"
  local src dist

  if [ -f "$BUILD_DIR/server/$name" ]; then
    puts-step "Copying $name to $BUILD_DIR"
    src="$BUILD_DIR/server/$name"
    dist="$BUILD_DIR/$name"

    if [ -f "$src" ]; then
      rm "$src"
    fi

    if ! cp "$src" "$dist"; then
      puts-warn "$!"
      exit 1
    fi
  fi
}

copy_from_server 'requirements.txt'
copy_from_server 'Pipfile'
copy_from_server 'setup.py'
